
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSchedule Pro (Firebase Cloud)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F8F9FE; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .scale-in-center { animation: scale-in 0.2s cubic-bezier(0.250, 0.460, 0.450, 0.940) both; }
        @keyframes scale-in { 0% { transform: scale(0.9); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .fade-in { animation: fade-in 0.3s ease-out; }
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        tr.clickable-row:hover { background-color: #EEF2FF; cursor: pointer; }
        
        /* Toast Notification Styles */
        #toast-container { position: fixed; bottom: 24px; right: 24px; z-index: 100; display: flex; flex-direction: column; gap: 12px; }
        .toast { background: white; padding: 16px 24px; border-radius: 16px; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); display: flex; items-center; gap: 12px; animation: slide-in-right 0.3s ease-out forwards; border-left: 6px solid; max-width: 350px; }
        .toast.success { border-left-color: #10B981; }
        .toast.error { border-left-color: #F43F5E; }
        .toast.info { border-left-color: #6366F1; }
        .toast.hiding { animation: fade-out 0.3s ease-in forwards; }
        @keyframes slide-in-right { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fade-out { to { opacity: 0; transform: translateY(10px); } }

        /* Loading Overlay */
        #loading-overlay { position: fixed; inset: 0; background: rgba(255,255,255,0.9); z-index: 9999; display: flex; flex-direction: column; justify-content: center; items-center; transition: opacity 0.3s; }
        #loading-overlay.hidden { opacity: 0; pointer-events: none; }
        .spinner { width: 40px; height: 40px; border: 4px solid #E2E8F0; border-top-color: #4F46E5; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Error Message in Loader */
        .loader-error { display: none; text-align: center; max-width: 400px; padding: 20px; }
        .loader-error.show { display: block; animation: fade-in 0.5s; }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body class="text-slate-700 h-screen overflow-hidden flex">

    <!-- Sidebar -->
    <div class="w-64 bg-white border-r border-slate-200 flex flex-col h-full z-20 shadow-sm flex-shrink-0">
        <div class="p-6 flex items-center gap-3">
            <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-indigo-200">
                <i class="fa-solid fa-graduation-cap text-lg"></i>
            </div>
            <span class="text-xl font-bold text-slate-800">課程系統</span>
        </div>

        <nav class="flex-1 px-4 space-y-2 mt-4" id="nav-menu">
            <!-- Nav Items injected by JS -->
        </nav>

        <div class="p-6 border-t border-slate-100 hidden">
            <button onclick="app.resetData()" class="w-full py-2 bg-rose-50 text-rose-600 rounded-lg text-sm font-bold hover:bg-rose-100 transition">
                <i class="fa-solid fa-trash-can mr-2"></i> 重置所有資料
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto relative w-full" id="main-content">
        <div class="p-8 pb-24 max-w-7xl mx-auto min-h-full" id="view-container">
            <!-- Views injected by JS -->
        </div>
    </main>

    <!-- Modals Container -->
    <div id="modal-overlay" class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4 transition-opacity duration-300">
        <div id="modal-content" class="bg-white w-full max-w-lg rounded-[2rem] p-8 shadow-2xl scale-in-center relative max-h-[90vh] overflow-y-auto no-scrollbar transition-all duration-300">
            <!-- Dynamic Content -->
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div id="loader-spinner" class="spinner mb-4"></div>
        <h3 id="loader-title" class="text-slate-800 font-bold text-lg">資料同步中...</h3>
        <p id="loader-desc" class="text-slate-400 text-sm">正在連線至雲端資料庫</p>
        
        <!-- Error Message Container -->
        <div id="loader-error-msg" class="loader-error mt-4">
            <div class="w-16 h-16 bg-rose-100 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl"><i class="fa-solid fa-triangle-exclamation"></i></div>
            <h3 class="text-xl font-bold mb-2 text-slate-800">無法載入應用程式</h3>
            <p class="text-sm text-slate-500 mb-6 leading-relaxed">
                1. 請確認檔案已使用 <strong>Live Server</strong> 開啟。<br>
                2. 檢查網路連線 (需載入 Firebase SDK)。<br>
                3. 請確認 index.js 路徑正確。
            </p>
        </div>
    </div>

    <!-- 
        Failsafe Script: 
        如果 5 秒後 app 沒有初始化成功，顯示錯誤訊息。
        延長時間是為了適應雲端預覽環境較慢的 CDN 下載速度。
    -->
    <script>
        setTimeout(() => {
            if (!window.app || !window.app.state) {
                document.getElementById('loader-spinner').style.display = 'none';
                document.getElementById('loader-title').style.display = 'none';
                document.getElementById('loader-desc').style.display = 'none';
                document.getElementById('loader-error-msg').classList.add('show');
            }
        }, 5000);
    </script>

    <!-- 
        修正：使用相對路徑 "index.js" (不加 / 開頭)
        確保在子資料夾或雲端環境中也能正確讀取
    -->
    <script type="module" src="index.js"></script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
